import s from"./MindmapMain.js";import t from"./common/Storage.js";import d from"./menuItems.js";import{LangManager as n}from"./common/LangManager.js";import{debounce as r}from"./common/Utils.js";const o=r(e=>{console.log("更新数据"),t.set("MindmapData",e)},500);customElements.define("mindmap-main",class extends s{constructor(){super(),this.langSource=new URL("./langs",import.meta.url).pathname,this.getMenuItems=d}triggerUpdate(){o(this.mindmapView.getMindMapRawData())}updateSetting(e,i){t.set(e,i)}async initSettings(){const e=t.get("isMinimapHidden",this.isMinimapHidden),i=t.get("curveStyle",this.curveStyle),a=t.get("theme")||this.theme,m=t.get("lang",n.currentLang);this.currentMinimapState=this.isMinimapHidden=e,this.mindmapView.currentCurveType=i,this.mindmapView.handleThemeChange(a),await n.whenInitialized,n.setLang(m)}setupEventListeners(){super.setupEventListeners(),document.addEventListener("mindmap-ready",()=>{const e=t.get("MindmapData");e&&(this.mindmapView.importExport.loadRawData(e),this.mindmapView.isRootNodeModified=!0,this.mindmapView.nodeEdit.nodeHistory.clear())},{once:!0}),this.addEventListener("new-mindmap",()=>this.mindmapView.newMindmap())}});
